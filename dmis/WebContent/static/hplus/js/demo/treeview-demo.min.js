$(function() {
	
	var checked=new Array();
	var unchecked=new Array();
	$("#qxfp").click(function(){
		var s = $("#table1").bootstrapTable('getSelections');
		var id = (s[0].rolecode);
		var i = 0;
		$.ajax({
	        type: "Post",
	        url: "/cems/menu/setTreeView.action",
	        data:{
	        	roleId : id
	        },
	        dataType: "json",
	        success: function (result) {
	       	 $('#tree').treeview({
	                data: result,         // 数据源
	                showIcon: true,
	                showCheckbox: true,   //是否显示复选框
	                highlightSelected: true,    //是否高亮选中
	                emptyIcon: '',    //没有子节点的节点图标
	                multiSelect: false,    //多选
	                onNodeChecked: function (event,data) {
	                    checked[i] = data ;
	                    i++;
	                    console.log(checked);
	                },
	       	 		nodeUnchecked: function(event,data){
	       	 			unchecked[i] = data ;
	       	 			i++;
	       	 			console.log(unchecked);
	       	 		}
	            });
	        },
	        error: function () {
	            alert("树形结构加载失败！")
	        }
	    });

	})
	
	
	$("#sub").click(function(){
		var arr = $('#tree').treeview('getChecked');
		var ids = ""; 
		for(var i = 0 ;i <arr.length; i++){
			var menu_id = arr[i].id ;
			ids = ids + menu_id + "," ;
		}
		debugger;
		console.log(ids);
		$.ajax({
			type: "Post",
			url: "/cems/role/giveMenu.action",
			data: {
				id: ids,
				name: "1111"
			},
			
			success: function(){
				alert("yes");
			},
			error :function(){
				alert("no")
			}
		});
		
	});
	
	
});
